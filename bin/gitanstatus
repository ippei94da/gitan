#! /usr/bin/env ruby
# coding: utf-8

#Show status of every git working trees.
#
require "gitan"
require "optparse"

## option analysis
OPTIONS = {}
op = OptionParser.new
op.on("-l",
      "--files-with-change",
      "Show only working trees with changes"){
  OPTIONS[:files_with_change] = true
}
op.parse!(ARGV)


if ARGV.empty?
  git_dir = ENV["HOME"] + "/git"
else
  git_dir = File::expand_path(ARGV[0])
end

Gitan::Repo.show_abbreviation($stdout)
Dir.glob(git_dir + "/*").sort.map do |path|
  next unless File.directory? path
  repo = Gitan::Repo.new(path)
  puts repo.short_status
end
